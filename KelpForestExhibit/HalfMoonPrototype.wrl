#VRML V2.0 utf8
# X3D-to-VRML-97 XSL translation autogenerated by X3dToVrml97.xslt
# https://www.web3d.org/x3d/content/X3dToVrml97.xslt
# Generated using XSLT processor: Saxonica

# [X3D] VRML V3.3 utf8
# PROFILE Immersive
# [X3D] version=3.3
# [X3D] noNamespaceSchemaLocation=https://www.web3d.org/specifications/x3d-3.3.xsd
# [head]

# META "title" "HalfMoonPrototype.x3d"
# META "description" "Prototype for a group of HalfMoon fish in the Kelp forest."
# META "creator" "Ildeniz Duman"
# META "translator" "Scott Tufts"
# META "created" "1 June 1998"
# META "modified" "20 October 2019"
# META "warning" "Additional PositionInterpolator present but disabled."
# META "warning" "Wiggle causes texture flashing. TODO: move animation to example file."
# META "identifier" "https://X3dGraphics.com/examples/X3dForWebAuthors/KelpForestExhibit/HalfMoonPrototype.x3d"
# META "generator" "X3D-Edit 3.3, https://savage.nps.edu/X3D-Edit"
# META "license" "../license.html"

# [Scene] ========== ========== ==========

NavigationInfo { type [ "EXAMINE" "ANY" ] } ###  Default X3D NavigationInfo

WorldInfo {
  title "HalfMoonPrototype.x3d"
}
PROTO HalfMoon [
  # [appinfo] HalfMoon fish

  exposedField MFString	skinTextureUrl [
"HalfMoonScalesPatch.jpg"
]
  exposedField SFVec3f	fishScale 0.3 0.25 0.25
  exposedField SFColor	fishColor 0.7 0.7 0.7
] {
  DEF MyHalfMoon Transform {
          scale IS fishScale
    children [
        Shape {
          appearance Appearance {
            material DEF FishColor Material {
                              diffuseColor IS fishColor
            }
            texture DEF FishTexture ImageTexture {
                              url IS skinTextureUrl
            }
          }
          geometry DEF Fish_Shape Extrusion {
            creaseAngle 1.57
            crossSection [ -0.1 1.0 0.1 1 0.5 0.5 0.5 -0.5 0.1 -1 -0.1 -1 -0.5 -0.5 -0.5 0.5 -0.1 1 ]
            scale [ 0.03 0.03 0.3 0.3 0.2 0.4 0.1 0.5 0.1 0.15 0.03 0.4 ]
            spine [ 0 1.5 0 0 1.2 0 0 0.5 0 0 0.3 0 0 0 0 0 -0.3 0 ]
          }
        }
        Shape {
          appearance DEF Fin_Skin Appearance {
            material Material {
              diffuseColor 0.5 0.5 0.5
              transparency 0.2
            }
          }
        }
        Transform {
          translation 1.37 0.1 0.1
          children [
              DEF Eye Shape {
                appearance Appearance {
                  material Material {
                    diffuseColor 0.5 0.5 0.5
                    shininess 1
                    specularColor 0.3 0.3 0.3
                  }
                }
                geometry Sphere {
                  radius 0.04
                }
              }
          ]
        }
        Transform {
          translation 1.37 0.1 -0.1
          children [
              USE Eye
          ]
        }
        Transform {
          scale 2.6 1 0.7
          translation 1.46 0 0
          children [
              # Mouth
              USE Eye
          ]
        }
        DEF Left_Pectoral Transform {
          translation 1.1 -0.15 -0.1
          children [
              Shape {
                appearance USE Fin_Skin
                geometry IndexedFaceSet {
                  coordIndex [ 0 1 2 -1 ]
                  solid FALSE
                  coord Coordinate {
                    point [ 0 0 0 0.2 0 0 -0.2 0 -0.2 ]
                  }
                }
              }
          ]
        }
        DEF Right_Pectoral Transform {
          translation 1.1 -0.15 0.1
          children [
              Shape {
                appearance USE Fin_Skin
                geometry IndexedFaceSet {
                  coordIndex [ 0 1 2 -1 ]
                  solid FALSE
                  coord Coordinate {
                    point [ 0 0 0 0.2 0 0 -0.2 0 0.2 ]
                  }
                }
              }
          ]
        }
        DEF AnimationGroup Group {
          children [
              DEF Timer TimeSensor {
                cycleInterval 5
                loop TRUE
              }
              DEF Waggler CoordinateInterpolator {
                key [ 0.0 0.15 0.28 0.4 0.55 0.7 0.85 1 ]
                keyValue [ 1.5 0 0 1.2 0 0 0.5 0 0 0.3 0 0 0 0 0 -0.3 0 0 1.5 0 0 1.20 0 0 0.5 0 .1 0.3 0 .2 0 0 0.25 -0.3 0 0.3 1.5 0 0 1.20 0 0 0.5 0 0 0.3 0 0 0 0 0 -0.3 0 0 1.5 0 0 1.2 0 0 0.5 0 -0.1 0.3 0 -0.2 0 0 -0.25 -0.3 0 -0.3 1.5 0 0 1.2 0 0 0.5 0 0 0.3 0 0 0 0 0 -0.3 0 0 1.5 0 0 1.2 0 0 0.5 0 0.1 0.3 0 0.2 0 0 0.25 -0.3 0 0.3 1.5 0 0 1.2 0 0 0.5 0 0 0.3 0 0 0 0 0 -0.3 0 0 1.5 0 0 1.2 0 0 0.5 0 -0.1 0.3 0 -0.2 0 0 -0.25 -0.3 0 -0.3 ]
              }
              DEF Left_Pectoral_Rotation OrientationInterpolator {
                key [ 0 0.3 0.7 1 ]
                keyValue [ 1 0 0 -0.52 1 0 0 0 1 0 0 0 1 0 0 -0.52 ]
              }
              DEF Right_Pectoral_Rotation OrientationInterpolator {
                key [ 0 0.3 0.7 1 ]
                keyValue [ 1 0 0 -0.52 1 0 0 0 1 0 0 0 1 0 0 -0.52 ]
              }
              # orbiting time
              DEF OrbitClock TimeSensor {
                cycleInterval 90
                enabled FALSE
                loop TRUE
              }
              DEF Orbit OrientationInterpolator {
                key [ 0.0 0.25 0.5 0.750 1 ]
                keyValue [ 0 1 0 6.28 0 1 0 1.57 0 1 0 3.14 0 1 0 4.71 0 1 0 6.28 ]
              }
              DEF HalfMoonPath PositionInterpolator {
                key [ 0 0.125 0.25 0.375 0.5 0.625 0.75 0.875 1 ]
                keyValue [ 15 2 0 15 0 -10 0 -1 -10 -15 0 -10 -15 2 0 -15 0 10 0 -2 10 15 0 10 15 2 0 ]
              }
          ]
        ROUTE Timer.fraction_changed TO Waggler.set_fraction
        ROUTE Waggler.value_changed TO Fish_Shape.set_spine
        ROUTE Timer.fraction_changed TO Left_Pectoral_Rotation.set_fraction
        ROUTE Left_Pectoral_Rotation.value_changed TO Left_Pectoral.set_rotation
        ROUTE Timer.fraction_changed TO Right_Pectoral_Rotation.set_fraction
        ROUTE Right_Pectoral_Rotation.value_changed TO Right_Pectoral.set_rotation
        ROUTE OrbitClock.fraction_changed TO Orbit.set_fraction
        ROUTE OrbitClock.fraction_changed TO HalfMoonPath.set_fraction
        ROUTE Orbit.value_changed TO MyHalfMoon.set_rotation
        ROUTE HalfMoonPath.value_changed TO MyHalfMoon.set_translation
        }
    ]
  }
}
# ====================
 HalfMoon {
}
