#VRML V2.0 utf8
# X3D-to-VRML-97 XSL translation autogenerated by X3dToVrml97.xslt
# https://www.web3d.org/x3d/content/X3dToVrml97.xslt
# Generated using XSLT processor: Saxonica

# [X3D] VRML V3.3 utf8
# PROFILE Immersive
# [X3D] version=3.3
# [X3D] noNamespaceSchemaLocation=https://www.web3d.org/specifications/x3d-3.3.xsd
# [head]

# META "title" "BooleanTogglePumpHouse.x3d"
# META "description" "A BooleanToggle node controls pump house animation: select to stop, then select again to restart."
# META "creator" "Todd Gagnon and Mark A. Boyd"
# META "translator" "Xeena VRML importer, X3D-Edit 3.1, https://www.web3d.org/x3d/content/README.X3D-Edit.html"
# META "created" "8 June 1998"
# META "translated" "20 December 2002"
# META "modified" "20 October 2019"
# META "reference" "KelpTank.x3d"
# META "reference" "https://X3dGraphics.com/examples/X3dForWebAuthors/KelpForestExhibit/PumpHouse.x3d"
# META "identifier" "https://X3dGraphics.com/examples/X3dForWebAuthors/Chapter09EventUtilitiesScripting/BooleanTogglePumpHouse.x3d"
# META "generator" "X3D-Edit 3.3, https://savage.nps.edu/X3D-Edit"
# META "generator" "Vrml97ToX3dNist, http://ovrt.nist.gov/v2_x3d.html"
# META "license" "../license.html"


EXTERNPROTO BooleanFilter [
  # [appinfo] Selectively pass only true or false events.
  eventIn  SFBool set_boolean # [appinfo] set_boolean is the input value to be filtered.
  eventOut SFBool inputTrue   # [appinfo] inputTrue only passes a true value, when set_boolean input is true.
  eventOut SFBool inputFalse  # [appinfo] inputFalse only passes a false value, when set_boolean is false.
  eventOut SFBool inputNegate # [appinfo] inputNegate provides opposite value by negating set_boolean input.
][
      "EventUtilityPrototypes.wrl#BooleanFilt
"https://www.web3d.org/x3d/content/examples/Basic/development/EventUtilityPrototypes.wrl#BooleanFilter"
      "EventUtilityPrototypes.x3d#BooleanFilter"
"https://www.web3d.org/x3d/content/examples/Basic/development/EventUtilityPrototypes.x3d#BooleanFilter"
 ]

    

EXTERNPROTO BooleanToggle [
  # [appinfo] Negate or reset prior boolean state, output result.
  eventIn  SFBool set_boolean    # [appinfo] If set_boolean input is true, toggle state.
  eventIn  SFBool set_toggle
  field    SFBool toggle         # [appinfo] Persistent state value that gets toggled or reset.
  eventOut SFBool toggle_changed
][
      "EventUtilityPrototypes.wrl#BooleanToggle"
"https://www.web3d.org/x3d/content/examples/Basic/development/EventUtilityPrototypes.wrl#BooleanToggle"
      "EventUtilityPrototypes.x3d#BooleanToggle"
"https://www.web3d.org/x3d/content/examples/Basic/development/EventUtilityPrototypes.x3d#BooleanToggle"
 ]

    

EXTERNPROTO TimeTrigger [
  # [appinfo] Convert boolean true events to time events.
  eventIn      SFBool	set_boolean    # [appinfo] If set_boolean input is true, trigger output time value.
  eventOut     SFTime	triggerTime    # [appinfo] triggerTime is output time event, sent when set_boolean input is true.
][
      "EventUtilityPrototypes.wrl#TimeTrigger"
"https://www.web3d.org/x3d/content/examples/Basic/development/EventUtilityPrototypes.wrl#TimeTrigger"
      "EventUtilityPrototypes.x3d#TimeTrigger"
"https://www.web3d.org/x3d/content/examples/Basic/development/EventUtilityPrototypes.x3d#TimeTrigger"
 ]

    
# [Scene] ========== ========== ==========

NavigationInfo { type [ "EXAMINE" "ANY" ] } ###  Default X3D NavigationInfo

WorldInfo {
  title "BooleanTogglePumpHouse.x3d"
}
Background {
  skyColor [ 1 1 1 ]
}
Viewpoint {
  description "Click pump house to toggle operation"
  orientation -0.969 0.239 0.056 0.13
  position 1.66 1.34 5.95
}
Group {
  children [
      Transform {
        scale 0.91 0.6 0.3
        translation 0.8 -0.65 0.5
        children [
            Shape {
              appearance Appearance {
                material Material {
                  diffuseColor 0.749 0.694 0.651
                }
              }
              geometry Cylinder {
                bottom FALSE
                top FALSE
              }
            }
        ]
      }
      Group {
        children [
            DEF PumpTouched TouchSensor {
               # description "touch to activate"
            }
            Shape {
              appearance DEF PumpHouseAppearance Appearance {
                material Material {
                  diffuseColor 0.82 0.78 0.74
                }
              }
              geometry IndexedFaceSet {
                coordIndex [ 0 1 5 4 -1 5 1 2 6 -1 6 2 3 7 -1 3 0 4 7 -1 1 12 13 2 -1 2 13 14 -1 12 15 16 13 -1 15 0 3 16 -1 16 3 17 -1 9 5 6 10 -1 8 9 10 11 -1 4 8 11 7 -1 4 5 9 8 -1 11 10 6 7 -1 3 2 14 17 -1 13 16 17 14 -1 ]
                coord Coordinate {
                  point [ 0.0 0.0 0.0 2.0 0.0 0.0 2.0 1.75 0.0 0.0 1.75 0.0 0.625 0.75 0.0 1.0 0.75 0.0 1.0 1.6 0.0 0.625 1.6 0.0 0.625 0.75 -0.65 1.0 0.75 -0.65 1.0 1.6 -0.65 0.625 1.6 -0.65 2.0 0.0 -2.7 2.0 1.75 -2.7 2.0 2.5 -1.0 0.0 0.0 -2.7 0.0 1.75 -2.7 0.0 2.5 -1.0 ]
                }
              }
            }
        ]
      }
  ]
}
Group {
  children [
      Transform {
        scale 0.5 0.5 0.5
        translation 1.0 1.1 -1.5
        children [
            DEF PistonTransform Transform {
              children [
                  Transform {
                    scale 1.8 1.2 0.6
                    translation 0.0 -0.2 0.0
                    children [
                        Shape {
                          appearance Appearance {
                            material Material {
                              diffuseColor 0.427 0.427 0.42
                            }
                          }
                          geometry Cylinder {
                            height 1.0
                            radius 0.98
                          }
                        }
                    ]
                  }
                  DEF CylinderRod Transform {
                    rotation 0.0 0.0 -1.0 0.523599
                    translation -0.25 0.75 0.0
                    children [
                        Shape {
                          appearance USE PumpHouseAppearance
                          geometry Cylinder {
                            height 1.0
                            radius 0.1
                          }
                        }
                    ]
                  }
                  Transform {
                    rotation 0.0 0.0 1.0 1.047198
                    translation 1.0 0.6 0.0
                    children [
                        USE CylinderRod
                    ]
                  }
                  Transform {
                    translation 0.0 1.2 0.0
                    children [
                        Shape {
                          appearance USE PumpHouseAppearance
                          geometry Sphere {
                            radius 0.15
                          }
                        }
                    ]
                  }
                  DEF RockerArm1 Transform {
                    center 0.0 -0.4 0.0
                    children [
                        Shape {
                          appearance USE PumpHouseAppearance
                          geometry Cylinder {
                            height 1.8
                            radius 0.1
                          }
                        }
                        Transform {
                          translation 0.0 0.95 0.0
                          children [
                              Shape {
                                appearance USE PumpHouseAppearance
                                geometry Sphere {
                                  radius 0.15
                                }
                              }
                          ]
                        }
                        DEF Rocker1Path PositionInterpolator {
                          key [ 0.0 0.3 0.32 0.5 0.75 1.0 ]
                          keyValue [ 0.0 2.0 -0.25 0.0 1.8 -0.35 0.0 1.8 -0.35 0.0 2.0 -0.25 0.0 2.0 -0.12 0.0 2.0 -0.25 ]
                        }
                        DEF Rocker1Rotation OrientationInterpolator {
                          key [ 0.0 0.3 0.32 0.5 0.75 1.0 ]
                          keyValue [ -1.0 0.0 0.0 0.523599 -1.0 0.0 0.0 1.0471976 -1.0 0.0 0.0 1.0471976 -1.0 0.0 0.0 0.523599 -1.0 0.0 0.0 0.2617994 -1.0 0.0 0.0 0.523599 ]
                        }
                    ]
                  }
                  DEF RockerArm2 Transform {
                    center 0.0 0.7 0.0
                    children [
                        Shape {
                          appearance USE PumpHouseAppearance
                          geometry Cylinder {
                            height 1.8
                            radius 0.1
                          }
                        }
                        Transform {
                          translation 0.0 -0.95 0.0
                          children [
                              Shape {
                                appearance USE PumpHouseAppearance
                                geometry Sphere {
                                  radius 0.15
                                }
                              }
                          ]
                        }
                        DEF Rocker2Path PositionInterpolator {
                          key [ 0.0 0.3 0.32 0.5 0.75 1.0 ]
                          keyValue [ 0.0 1.95 -1.0 0.0 1.2 -1.6 0.0 1.2 -1.6 0.0 1.95 -1.0 0.0 2.2 -0.65 0.0 1.95 -1.0 ]
                        }
                        DEF Rocker2Rotation OrientationInterpolator {
                          key [ 0.0 0.3 0.32 0.5 0.75 1.0 ]
                          keyValue [ 1.0 0.0 0.0 0.523599 1.0 0.0 0.0 0.4 1.0 0.0 0.0 0.4 1.0 0.0 0.0 0.523599 1.0 0.0 0.0 1.570796 1.0 0.0 0.0 0.523599 ]
                        }
                    ]
                  }
              ]
            }
            DEF PistonClock TimeSensor {
              cycleInterval 5.5
              loop TRUE
              startTime 1
            }
            DEF PistonPath PositionInterpolator {
              key [ 0.0 0.3 0.32 0.5 0.75 1.0 ]
              keyValue [ -0.4 -2.3 4.0 -0.4 -1.5 4.0 -0.4 -1.5 4.0 -0.4 -2.3 4.0 -0.4 -3.3 4.0 -0.4 -2.3 4.0 ]
            }
            DEF Toggler BooleanToggle {
            }
            DEF Tee BooleanFilter {
            }
            DEF PauseOn TimeTrigger {
            }
            DEF PauseOff TimeTrigger {
            }
        ]
      }
  ]
}
DEF Dump Script {
  eventIn      SFBool	dumpSFBool
  eventIn      SFTime	dumpSFTime

	url [ "BooleanTogglePumpHouseScript.js" "https://X3dGraphics.com/examples/X3dForWebAuthors/Chapter09EventUtilitiesScripting/BooleanTogglePumpHouseScript.js"
 ]
}
ROUTE PumpTouched.isActive TO Toggler.set_boolean
ROUTE Tee.inputTrue TO Dump.dumpSFBool
ROUTE PauseOn.triggerTime TO Dump.dumpSFTime
ROUTE Toggler.toggle_changed TO Tee.set_boolean
ROUTE Tee.inputTrue TO PauseOn.set_boolean
ROUTE Tee.inputFalse TO PauseOff.set_boolean
ROUTE PauseOn.triggerTime TO PistonClock.pauseTime
ROUTE PauseOff.triggerTime TO PistonClock.resumeTime
ROUTE PistonClock.fraction_changed TO PistonPath.set_fraction
ROUTE PistonPath.value_changed TO PistonTransform.set_translation
ROUTE PistonClock.fraction_changed TO Rocker1Path.set_fraction
ROUTE Rocker1Path.value_changed TO RockerArm1.set_translation
ROUTE PistonClock.fraction_changed TO Rocker1Rotation.set_fraction
ROUTE Rocker1Rotation.value_changed TO RockerArm1.set_rotation
ROUTE PistonClock.fraction_changed TO Rocker2Path.set_fraction
ROUTE Rocker2Path.value_changed TO RockerArm2.set_translation
ROUTE PistonClock.fraction_changed TO Rocker2Rotation.set_fraction
ROUTE Rocker2Rotation.value_changed TO RockerArm2.set_rotation
